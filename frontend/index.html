<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/src/assets/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1, user-scalable=no" />
    <meta
      name="description"
      content="Online platform for Nazarbaiev university students"
    />
    <meta name="keywords" content="nuspace, buy, sell, products, students" />
    <link rel="apple-touch-icon" href="src/assets/icons/apple-icon-180.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrai
    t)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landsca
    pe)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1640-2360.jpg" media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2360-1640.jpg" media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1488-2266.jpg" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2266-1488.jpg" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscap
    e)">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1320-2868.jpg" media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2868-1320.jpg" media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1206-2622.jpg" media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2622-1206.jpg" media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1260-2736.jpg" media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2736-1260.jpg" media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    >
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape
    )">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    >
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)
    ">
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    >
    <link rel="apple-touch-startup-image" href="src/assets/icons/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)
">

    <link rel="manifest" href="/src/assets/manifest.json">
    <title>Nuspace</title>
    <script>
      // Telegram WebApp script loading with fallback for Android compatibility
      window.telegramScriptLoaded = false;
      window.telegramScriptError = false;
      window.telegramLoadAttempts = 0;
      window.__telegramScriptDispatched = false;
      window.__telegramImmediateInitDone = false;
      
      function loadTelegramScript() {
        window.telegramLoadAttempts++;
        console.log(`Attempting to load Telegram WebApp script (attempt ${window.telegramLoadAttempts})`);
        
        const script = document.createElement('script');
        script.src = 'https://telegram.org/js/telegram-web-app.js?59';
        script.async = true;
        
        script.onload = function() {
          window.telegramScriptLoaded = true;
          console.log('Telegram WebApp script loaded successfully');

          // Guard: dispatch only once
          if (!window.__telegramScriptDispatched) {
            window.__telegramScriptDispatched = true;
            window.dispatchEvent(new CustomEvent('telegramScriptLoaded'));
          }

          // Immediate light init to help Android WebView when hooks mount late
          try {
            if (!window.__telegramImmediateInitDone && window.Telegram && window.Telegram.WebApp) {
              window.__telegramImmediateInitDone = true;
              const tg = window.Telegram.WebApp;
              // Soft init only, no style mutations here
              tg.ready && tg.ready();
              setTimeout(() => tg.expand && tg.expand(), 150);
            }
          } catch {}
        };
        
        script.onerror = function() {
          window.telegramScriptError = true;
          console.error(`Failed to load Telegram WebApp script (attempt ${window.telegramLoadAttempts})`);
          
          // Retry up to 3 times with increasing delays
          if (window.telegramLoadAttempts < 3) {
            const delay = window.telegramLoadAttempts * 2000; // 2s, 4s, 6s
            console.log(`Retrying in ${delay}ms...`);
            setTimeout(loadTelegramScript, delay);
          } else {
            console.error('Failed to load Telegram WebApp script after 3 attempts');
            // Dispatch failure event
            if (!window.__telegramScriptDispatched) {
              window.__telegramScriptDispatched = true;
              window.dispatchEvent(new CustomEvent('telegramScriptFailed'));
            }
          }
        };
        
        // Remove any existing script to avoid duplicates
        const existingScript = document.querySelector('script[src*="telegram-web-app.js"]');
        if (existingScript) {
          existingScript.remove();
        }
        
        document.head.appendChild(script);
      }
      
      // Start loading immediately
      loadTelegramScript();
      
      // Fallback timeout - if script doesn't load in 10 seconds, try again
      setTimeout(function() {
        if (!window.telegramScriptLoaded && !window.telegramScriptError) {
          console.warn('Telegram script loading timeout, forcing retry...');
          loadTelegramScript();
        }
      }, 10000);
    </script>
  </head>
  <body>
    <div id="root"></div>
    
    <script type="module" src="/src/app/main.tsx"></script>
  </body>
</html>
